<!DOCTYPE html>
<html lang="en">
<head>
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@4.x/css/materialdesignicons.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
</head>
<style>
    pre {
        max-height: 400px;
        white-space: pre-wrap;
        overflow-wrap: break-word;
        overflow-x:hidden;
        white-space: -moz-pre-wrap;
        white-space: -o-pre-wrap;
        word-wrap: break-word;
    }
    input, select  {
        width: 80%;
        padding: 12px 20px;
        margin: 8px 0;
        display: inline-block;
        border: 1px solid #ccc;
        border-radius: 4px;
        box-sizing: border-box;
    }

    input[type=submit] {
        width: auto;
        min-width: 100px;
        background-color: #4CAF50;
        color: white;
        padding: 14px 20px;
        margin: 8px 0;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }

    input[type=checkbox] {
        width: auto;
    }

    input[type=submit]:hover {
        background-color: #45a049;
    }

    .container {
        border-radius: 5px;
        background-color: #f2f2f2;
        padding: 20px;
    }
</style>
<body>

<div id="app">
    <v-app>
        <v-content>
            <v-container>
                <h3>{{ title }}</h3>

                <div class="container">
                    <form id="settings_form">
                        <label for="input_link">Site address</label>
                        <br>
                        <input id="input_link" name="link" placeholder="Link" required>
                        <input placeholder="Email address" name="email" type="email" required>
                        <select name="outputFormat" id="format" >
                            <option value="csv">CSV</option>
                            <option value="xls">XLS</option>
                        </select>
                        <br>
                        <input type="checkbox" id="logs" name="logs">
                        <label for="logs">Show output</label>
                        </br>
                        <div>
                            <input type="submit" id="submit_btn" value="Run">
                        </div>
                    </form>
                    <div>
                        <v-btn @click="status">Check status</v-btn>
                        <v-btn @click="monitoring" >Monitoring</v-btn>
                        <v-btn @click="clear_log">Clear logs</v-btn>
                    </div>
                    <div id="result"><pre ref="result">{{ console }}</pre></div>
                </div>
            </v-container>
        </v-content>
    </v-app>
</div>

</body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="script.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.0/axios.min.js"></script>
<script>
    new Vue({
        el: '#app',
        vuetify: new Vuetify(),
        data: () => ({
            title: "Screaming Frog Launcher",
            console: "",
            monitioringRun: false
        }),
        methods : {
            monitoring () {
                this.monitoringRun = !this.monitoringRun;
                const self = this;
                if ( this.monitoringRun ) {
                    self.interval = setInterval(function() {
                        self.status();
                    }, 1000);
                } else {
                    clearInterval( self.interval );
                }
            },
            status () {
                axios.get( 'check_status.php' ).then(
                    response => {
                        if ( response.data ) {
                            this.console += response.data + "\n";
                            var container = this.$refs.result;
                            container.scrollTop = container.scrollHeight;
                        }
                    }
                );
            },
            clear_log () {
                this.console = "";
            }
        }
    })
</script>
</html>
